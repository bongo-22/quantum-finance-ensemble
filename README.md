# Quantum-Classical Hybrid Ensemble for Financial Time Series Classification
## Квантово-классический ансамбль для классификации финансовых временных рядов

[![Python 3.9+](https://img.shields.io/badge/python-3.9+-blue.svg)](https://www.python.org/downloads/)
[![Qiskit](https://img.shields.io/badge/Qiskit-0.43+-green.svg)](https://qiskit.org/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

---

## Описание проекта

В работе исследуется гибридный квантово-классический ансамбль для бинарной классификации финансовых временных рядов.

Сравниваются:

- Классические модели машинного обучения  
- Одиночный вариационный квантовый классификатор (VQC)  
- Ансамбль нескольких VQC с разными feature maps (stacking)

Цель — определить, способен ли квантовый ансамбль:

- превзойти одиночные квантовые модели,
- конкурировать с классическими алгоритмами,
- показать прирост качества за счёт разнообразия квантовых представлений данных.

---

## Данные

- Актив: AAPL  
- Период: 2015–2023  
- Источник: Yahoo Finance  

### Используемые признаки:

- Дневная доходность (Return)
- Волатильность (скользящее окно 5 дней)
- Скользящая средняя MA5
- Скользящая средняя MA10

### Целевая переменная:

Бинарная классификация направления движения цены на следующий день.

Разделение выборки: 80% обучение / 20% тест (без перемешивания).

---

## Классические модели

| Модель               | Accuracy | F1-score |
|----------------------|----------|----------|
| Logistic Regression  | 0.4838   | 0.5369   |
| Random Forest        | 0.4938   | 0.2039   |
| XGBoost              | 0.4838   | 0.4234   |

Baseline accuracy: **0.5087**

Классические модели не превзошли baseline.

---

## Вариационный квантовый классификатор (VQC)

Параметры:

- Feature Map: ZZFeatureMap (4 кубита, reps=1)
- Ansatz: RealAmplitudes (4 кубита, reps=2)
- Оптимизатор: COBYLA
- Время обучения: ~937 секунд

**Accuracy VQC: 0.5212**

Одиночная квантовая модель показала лучший результат среди всех моделей.

---

## Квантовый ансамбль (Stacking)

Использовались три VQC с разными feature maps:

- ZZFeatureMap (reps=1)
- ZZFeatureMap (reps=2)
- PauliFeatureMap (Z, ZZ)

Мета-модель: Logistic Regression

**Stacking Accuracy: 0.5087**

Ансамбль не превзошёл одиночную квантовую модель.

---

## Статистическая оценка

5 запусков с разными seed:

- VQC mean accuracy: 0.4988  
- VQC std: 0.0130  
- Ensemble mean accuracy: 0.5087  
- t-stat: -1.5339  
- p-value: 0.1636  

Статистически значимого улучшения ансамбля не обнаружено (p > 0.05).

---

## Масштабирование по числу кубитов

Эксперимент для 2–4 кубитов показал:

- Рост числа кубитов не приводит к гарантированному улучшению качества.
- Увеличение сложности схемы не компенсирует ограниченность признаков и данных.

---

## Основные выводы

- Одиночный VQC продемонстрировал конкурентоспособный результат.
- Классические модели не показали преимущества на выбранных признаках.
- Квантовый ансамбль не дал статистически значимого прироста.
- Финансовые временные ряды остаются сложной задачей для обеих парадигм.

---

## Запуск

Установка зависимостей:

```bash
pip install -r requirements.txt
